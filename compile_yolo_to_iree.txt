Python:
from ultralytics import YOLO
YOLO('yolov8n.pt').export(format='onnx', imgsz=640, dynamic=False)


Console:
iree-import-onnx yolov8n.onnx --opset-version 17 -o yolov8n.mlir
iree-compile \
  yolov8n.mlir \
  --iree-hal-target-device=local \
  --iree-hal-local-target-device-backends=llvm-cpu \
  --iree-llvmcpu-target-cpu=host \
  -o yolov8n.vmfb



Python:
with open('yolov8n.vmfb', 'rb') as f:
    model = rt.load_vm_flatbuffer(f.read(), driver="local-task")
model.main_graph(torch.rand(1,3,640,640))
